# Images to PDF (PowerShell)

フォルダ内の PNG / JPEG 画像をまとめて  
1つの PDF に変換する PowerShell スクリプトです。

フォルダを指定するだけで、その配下の画像を自動取得し、
日付形式（yyyyMMdd）のPDFを生成します。

---

## 🚀 特徴

- フォルダ選択ダイアログ付き
- PNG / JPG / JPEG に対応
- サブフォルダを含めて再帰取得
- 画像比率を維持して中央配置
- 1画像 = 1ページ
- 外部ライブラリ不要
- Windows標準機能のみで動作

---

## 📦 動作環境


# Images to PDF (PowerShell)

PNG / JPEG 画像をまとめて 1 つの PDF に変換する PowerShell スクリプトです。

※ 本スクリプトは本体を置いたフォルダ内（同階層）の画像ファイルを対象とします。

---



## 📦 動作環境

- Windows 10 / 11
- PowerShell 5.1 以上
- Microsoft Print to PDF が有効

※ 追加インストール不要

---

## 🛠 使い方

### ① 実行ポリシー設定（初回のみ）

PowerShellを開き、以下を実行：

```powershell
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
```

### ② 必要に応じてサフィックスを変更

`ImagesToPdf.ps1` の先頭にある `$FilenameSuffix` に好みの文字列（例: `_領収書`）を設定してください。

### ③ スクリプトを実行

`ImagesToPdf.ps1` を保存しているフォルダに移動し、PowerShell から実行します：

```powershell
.\ImagesToPdf.ps1
```

実行中の挙動:
- フォルダ内（同階層）の PNG / JPG / JPEG を列挙します
- 画像が無ければ「画像ファイルが見つかりません: <フォルダパス>」を表示して終了します
- 出力先の PDF が既にある場合は上書き確認を行い、ユーザーが `y` 相当を入力したときのみ上書きします
- 上書きに失敗した場合は（例: 既にファイルが開かれている）メッセージを表示して処理を中止します

---

## 注意点

- スクリプト配置フォルダ内の画像ファイルを対象に処理します
- サブフォルダの再帰取得は行いません（同階層のみ）
- 画像が見つからない場合はメッセージを表示して終了します
- 出力PDFが既に存在する場合は上書きの確認を行い、ユーザーが許可した場合のみ上書きします
	- 上書き準備（既存ファイルの削除）に失敗した場合（例: PDF が開かれている等）は処理を中止し、メッセージを出力します
- 出力ファイル名のサフィックス部分はスクリプト先頭の `$FilenameSuffix` でハードコーディング可能
